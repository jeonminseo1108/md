# md

# SNU CS M1522.00800 : System Programming - Sample Midterm Questions

We have prepared some practice problems related to linking that we have covered this week.  
These problems have been selected from those generated by **AI tools (Cramify and ChatGPT)**,  
based on your textbook content and previous exam questions.

There is no need to submit anything after reviewing this material,  
but we hope it will help you prepare for the upcoming midterm.  
Also, note that some problems may contain important concepts beyond linking.

---

We don't provide the answers to the sample midterm questions.  
Instead, engage in discussions with your peers to find the answers to each question.  
This will improve your understanding and better prepare you for the exam.

## Question 1.
Consider the following statement:  
True or False: If a variable is declared as “static” inside a source file, it can still be accessed from other source files if they are linked together during compilation.


## Question 2.
Consider the executable object file `a.out`, which is compiled and linked using the following command:  
`$ gcc800 -o a.out main.c foo.c`  
Files `main.c` and `foo.c` consist of the following code. What is the output of `a.out`?

```c
// main.c
#include <stdio.h>

static int a = 1;
int b = 2;
int c;

void foo();

int main(){
    int c = 3;

    foo();
    printf("a=%d, b=%d, c=%d\n", a, b, c);
    return 0;
}
```

```c
// foo.c
int a;
extern int b, c;

void foo(){
    a = 4;
    b = 5;
    c = 6;
}
```

## Question 3.
What is the best definition of static linking?  
- `A process that combines relocatable object files to form an executable object file.  `
- `A method of linking that occurs at run time.  `
- `A technique that allows for dynamic loading of libraries.  `
- `A process that resolves symbols at load time.`


## Question 4.
Which section in an ELF relocatable object file contains initialized global and static variables?  
- `.text`  
- `.rodata`  
- `.data`  
- `.bss`

## Qusetion 5. 
Consider the following two files that are compiled and linked together:

```c
/* file1.c */
#include <stdio.h>

int x = 10;

void foo();

int main() {
    printf("%d\n", foo());
    return 0;
}
```

```c
/* file2.c */
static int foo() {
    return 5;
}
```
True or False: The program will compile successfully and the output will be 5


## Qusetion 6. 
Given the following code:

```c
/* file1.c */
#include <stdio.h>

extern int x;
int main() {
    printf("%d\n", x);
    return 0;
}
```

```c
/* file2.c */
int x = 10;
```
If you compile and link these two files using `gcc -o a.out file1.c file2.c`, what is the expected output of the program?

- `Compile error`  
- `0`
- `10`
- `Undefined behavior`


# SNU CS M1522.00800 : System Programming - Sample Midterm Questions

We have prepared some practice problems for upcoming midterm.  
These problems have been selected and modified from those generated by **AI tools (Cramify and ChatGPT)**,  
based on your textbook content and previous exam questions.

The following problem is based on concepts from the CS:APP textbook (Chapters 7.0 - 7.15, 10.0 - 10.4, and 10.6 - 10.12).

There is no need to submit anything after reviewing this material,  
but we hope it will help you prepare for the upcoming midterm.  
Also, note that some problems may contain important concepts that go beyond what you have learned.

---

We don't provide the answers to the sample midterm questions.  
Instead, engage in discussions with your peers to find the answers to each question.
Of course, you may ask questions to the professor and TAs through the campuswire.
This will improve your understanding and better prepare you for the exam.

## Question 1.
Consider the C program below. For brevity, assume that we do not check error return codes, 
that is, all functions return normally. Also assume that we have included all the header files
we need. What is the output of the following program?

```c
// main.c
int main() {
    int fd1, fd2;
    char c;

    fd1 = open("input1.txt", O_RDONLY);
    if (fork() == 0) {
        read(fd1, &c, 1);
        close(fd1);
        exit(0);
    }

    wait(NULL);

    dup2(fd1, fd2);
    read(fd1, &c, 1);
    read(fd2, &c, 1);
    printf("read: %c\n", c);

    close(fd1);
    exit(0);
}
```


## Question 2.
Consider the C program below. For brevity, assume that we do not check error return codes, 
that is, all functions return normally. Also assume that we have included all the header files
we need. What is the output of the following program?

```c
// main.c
int main() {
    int fd1, fd2;
    char c1, c2;

    fd1 = open("input1.txt", O_RDONLY);

    read(fd1, &c1, 1);

    if (fork() == 0) {
        read(fd1, &c1, 1);
        exit(0);
    }

    wait(NULL);

    fd2 = open("input1.txt", O_RDONLY);

    read(fd1, &c1, 1);
    read(fd2, &c2, 1);

    printf("c1: %c\n", c1);
    printf("c2: %c\n", c2);

    close(fd1);
    close(fd2);
    exit(0);
}
```

## Question 3.
In this problem, let `REF(x.i) → DEF(x.k)` denote that the linker will associate an arbitrary reference 
to symbol `x` in module `i` to the definition of `x` in module `k`. 
For each example that follows, use this notation to indicate how the linker would resolve references 
to the multiply-defined symbol in each module. 
If there is a link-time error (rule 1), write "ERROR". 
If the linker arbitrarily chooses one of the definitions (rule 3), write "UNKNOWN".

#### A. 

```c
// module 1
int main()
{
}
```

```c
// module2
int main;
int p2()
{
}
```
(a) REF(main.1) → DEF(__________)

(b) REF(main.2) → DEF(__________)


#### B. 
```c
// module 1
int main()
{
}
```

```c
// module2
int main = 1;
int p2()
{
}
```
(a) REF(main.1) → DEF(__________)

(b) REF(main.2) → DEF(__________)

#### C. 
```c
// module 1
int main()
{
}
```

```c
// module2
int __attribute__((weak)) main;
int p2()
{
}
```
(a) REF(main.1) → DEF(__________)

(b) REF(main.2) → DEF(__________)

#### D. 
```c
// module 1
int __attribute__((weak)) main()
{
}
```

```c
// module2
#pragma weak main
int main;
int p2()
{
}
```
(a) REF(main.1) → DEF(__________)

(b) REF(main.2) → DEF(__________)


## Question 4.

#### A. 
Discuss the advantages of separating the `.bss` and `.data` sections in memory.

#### B. 
Explain the difference between internal fragmentation and external fragmentation.

#### C. 
Why is a multi-level page table used in memory management? Discuss its advantages and disadvantages.

#### D. 
Explain the difference between a page fault and a segmentation fault.


## Qusetion 5. 
Consider the call to the function `swap` in the object file `m.o`.

```assembly
9: e8 00 00 00 00      callq e <main+0xe>    swap()
```
with the following relocation entry:
```
r.offset = 0x10
r.symbol = func
r.type   = R_X86_64_PC32
r.addend = -6
```
Now suppose that the linker relocates .text in m.o to address 0x500500 and swap to address 0x500530.
What is the value of the relocated reference to swap in the callq instruction?
